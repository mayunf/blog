---
title: Linux系统使用iftop查看带宽占用情况
date: 2018-12-15 15:26:14
tags:
- linux
---

linux系统下如果服务器带宽跑满了，查看跟哪个ip通信占用带宽比较多，可以通过iftop命令进行查询，使用方法如下：

## 安装

[官网](http://www.ex-parrot.com/~pdw/iftop/?spm=5176.776699467.2.5.DK8cKp)

CentOS系统：
`yum install iftop`

Debian/Ubuntu系统：
`apt-get install iftop`

## 使用

`sudo iftop -i eth1 -P`

注：-P 参数会将请求服务的端口显示出来，也就是说是通过服务器哪个端口建立的连接，看内网流量执行 iftop -i eth0 -P 命令。

![http://img01.taobaocdn.com/tfscom/TB1m14oJFXXXXa.XpXXXXXXXXXX.jpg](http://img01.taobaocdn.com/tfscom/TB1m14oJFXXXXa.XpXXXXXXXXXX.jpg)


iftop界面含义如下

第一行：带宽显示

中间部分：外部连接列表，即记录了哪些ip正在和本机的网络连接

中间部分右边：实时参数分别是该访问ip连接到本机2秒，10秒和40秒的平均流量=>代表发送数据，<= 代表接收数据

底部三行：表示发送，接收和全部的流量

底部三行第二列：为你运行iftop到目前流量

底部三行第三列：为高峰值

底部三行第四列：为平均值
通过iftop的界面很容易找到哪个ip在占用网络流量，这个是ifstat做不到的。不过iftop的流量显示单位是Mb,这个b是bit，是位，不是字节，而ifstat的KB，这个B就是字节了，byte是bit的8倍。

 

进入iftop画面后的一些操作命令(注意大小写)

按h切换是否显示帮助;

按n切换显示本机的IP或主机名;

按s切换是否显示本机的host信息;

按d切换是否显示远端目标主机的host信息;

按t切换显示格式为2行/1行/只显示发送流量/只显示接收流量;

按N切换显示端口号或端口服务名称;

按S切换是否显示本机的端口信息;

按D切换是否显示远端目标主机的端口信息;

按p切换是否显示端口信息;

按P切换暂停/继续显示;

按b切换是否显示平均流量图形条;

按B切换计算2秒或10秒或40秒内的平均流量;

按T切换是否显示每个连接的总流量;

按l打开屏幕过滤功能，输入要过滤的字符，比如ip,按回车后，屏幕就只显示这个IP相关的流量信息;

按L切换显示画面上边的刻度;刻度不同，流量图形条会有变化;

按j或按k可以向上或向下滚动屏幕显示的连接记录;

按1或2或3可以根据右侧显示的三列流量数据进行排序;

按<根据左边的本机名或IP排序;

按>根据远端目标主机的主机名或IP排序;

按o切换是否固定只显示当前的连接;

按f可以编辑过滤代码；

按!可以使用shell命令；

按q退出监控。
